# 招采审计 Web 端 PRD（数据中台对接）
**版本：0.1**  
**产品代号：招采审计（MVP）**  
**适用范围：仅招采审计；单一角色：审计人员（对自己创建的项目拥有全部权限）**

---

## 1. 背景与产品价值

### 1.1 背景
招采审计的工作强依赖“招标文件 + 项目资料包”。传统做法中，审计人员需要在大量文件中手工定位关键信息、反复核对依据与结论，效率低、证据链难沉淀、交付一致性差。

### 1.2 产品定位
一个面向审计人员的 **招采审计工作台（Web）**：
- 以“招标文件解析确认”作为项目初始化入口；
- 以“文件→关键信息→台账→审计→风险报告”串成可执行闭环；
- 所有抽取与结论都要求“可追溯到原文证据”。

### 1.3 核心价值（务实可验收）
1) **效率**：把“找信息/抄信息”变成“确认信息”。  
2) **可追溯**：字段、审计结论、风险项都能回溯到原文位置（页码/片段/定位）。  
3) **一致性**：同类项目可复用相同规则与台账口径，降低交付波动。  
4) **可扩展**：数据中台提供统一数据接口；App 侧只存项目过程数据，后续扩展功能不反噬中台。

---

## 2. 用户与角色（本期简化）
- **审计人员（唯一角色）**
  - 创建项目、上传文件、确认抽取、生成台账、执行审计、输出风险报告
  - 仅管理自己创建的项目（权限逻辑本期不展开）

---

## 3. 产品范围与边界

### 3.1 本期范围（必须实现）
1) 新建项目：上传招标文件 → 判定是否招标文件 → 解析字段 → 原文回溯 → 确认创建项目  
2) 项目资料上传：批量上传、去重提示、预览、状态管理  
3) 文件分拣：自动分拣 + 人工修正 + 批量确认  
4) 关键信息库：按文件维度抽取字段、人工确认、原文回溯、缺失标记  
5) 项目台账：从已确认信息汇总生成；支持人工补录、证据来源展示、导出 Excel  
6) 审计：选择规则集 → 执行 → 展示过程/证据/依据 → 生成风险记录  
7) 风险报告：风险清单编辑 → 一键生成报告 → 导出（PDF/Word 至少一种）

### 3.2 明确不做（本期不做）
- 多角色/权限体系、审批流、多人协同  
- 数据中台侧的增删改查（中台已有 UI/接口承接）  
- Word 在线预览方案（先不作为阻塞项）  
- 高级排版编辑器（报告先模板化导出，少量文本可编辑即可）

---

## 4. 关键业务流程（MVP）

### 4.1 总流程
1) **新建项目（必须上传招标文件）**  
2) 上传其他文件 → 分拣 → 提取 → 确认入库  
3) 生成项目台账（自动汇总 + 可补录）  
4) 选择审计逻辑执行 → 生成风险记录  
5) 生成风险报告并导出

### 4.2 新建项目（招标文件解析确认）
**输入：** 招标文件（PDF/Word/图片）  
**输出：** 项目 + 招标文件记录 + 招标文件关键信息（已确认）  

**页面布局：左预览 / 右字段确认**
- 左侧：招标文件预览（页码跳转、搜索）
- 右侧：字段列表（分组、状态、可编辑、可回溯原文）

**招标文件解析字段（本期固定）**
- 项目名称（确认后作为系统项目名称）
- 服务范围/建设规模
- 开标时间
- 服务期限
- 投标截止时间
- 投标人资格条件-投标人资质能力
- 投标人资格条件-项目负责人资质能力
- 投标人资格条件-类似业绩类似项目
- 评标委员会组成
- 联合体投标
- 合同价格形式
- 招标方式
- 资格审查方式
- 评标方法
- 投标保证金
- 履约保证金金额百分比
- 招标文件获取时间
- 最高投标限价
- 招标人书面澄清的时间
- 废标条款
- 评标标准
- 是否有特定标准描述

**字段交互要求**
- 每个字段展示：抽取值（可改）、状态（自动/待确认/缺失）、【查看原文证据】  
- 支持：缺失字段手填；或标记“未在原文找到”（保留原因备注）  
- 点击【确认无误并创建项目】后：  
  - 项目名称 = 该页“项目名称”的确认值  
  - 招标文件进入项目文件列表，并生成该文件的关键信息记录（已确认）

---

## 5. 页面与信息架构（Web）

### 5.1 首页：项目列表
- 新建项目（强制上传招标文件）
- 项目卡片信息：项目名称、创建时间、进度、待确认数、风险数

### 5.2 新建项目页：招标文件解析确认（关键页）
- 左：预览（证据定位高亮）
- 右：字段确认（分组展示 + 原文回溯）

### 5.3 项目工作台（项目内主页面）
建议采用“步骤式工作区”，顶部展示进度与关键入口：
1) 资料上传与分拣
2) 关键信息库（按文件）
3) 项目台账
4) 审计
5) 风险报告

> 不使用“选项卡式”导航；用“步骤卡片 + 任务队列”让业务人员不迷路。

### 5.4 资料上传与分拣页
- 上传区：支持批量上传；上传前本地计算 sha256，提示是否重复（复用或跳过）
- 文件队列列表（核心）：
  - 文件名 / 状态 / 文件类型（可改）/ 操作（预览、进入字段表、重新提取）
- 批量操作：批量改类型、批量确认分拣、批量触发提取

### 5.5 文件关键信息页（按文件维度）
- 左：文件预览
- 右：字段表（来自数据中台字段定义）
- 字段支持：回溯原文、缺失标记、单条/全部确认

### 5.6 项目台账页（本期固定字段）
台账字段：
- 项目名称
- 招标人公司名称
- 招标人联系电话
- 招标方式
- 招标代理机构名称
- 招标代理机构联系人
- 最高投标限价
- 投标人公司名称
- 投标金额
- 投标人联系人
- 投标人联系电话
- 是否中标

交互要求：
- 每个字段显示“值 + 来源（文件/字段）+ 证据回溯”
- 支持人工补录（并标注来源=人工）
- 导出 Excel
- 输出“缺失字段清单”（用于补资料）

### 5.7 审计页
- 规则选择：按阶段/板块筛选（规则来自数据中台）
- 执行审计：规则结果（通过/不通过/缺失/需复核）
- 每条规则可展开查看：
  - 使用了哪些字段（从项目关键信息库/台账读取）
  - 证据回溯（定位到文件预览）
  - 依据（法规/条款引用）

### 5.8 风险记录与报告页
- 风险清单：可编辑描述/建议/严重程度；可定位证据
- 一键生成报告：模板化组织（按板块/规则）
- 导出：PDF/Word（至少一种）

---

## 6. App 侧数据模型（业务口径）
> 使用“通用 KV 表”存每个文件的关键信息；不做“每文件一张表”。

### 6.1 必要实体
1) 项目 Project  
2) 项目文件 ProjectFile（含 fileAssetId、docTypeCode、状态）  
3) 通用 KV：FileFieldValue（核心）
4) 项目台账 ProjectLedger（固定字段）  
5) 审计风险 AuditRisk（核心）  
6) 证据引用 EvidenceRef（用于原文回溯）

### 6.2 通用 KV（建议字段）
- projectId
- projectFileId
- docTypeCode
- fieldCode
- fieldName（冗余，便于查询与展示）
- value（字符串/JSON）
- status（auto / pending / confirmed / missing）
- evidenceRef（JSON：page、snippet、bbox/anchor 可选）
- updatedAt

---

## 7. 与数据中台的接口（对接清单）
> 数据中台仅用于存储“通用数据”（文件类型、字段定义、审计规则、法规标准、文件资产），并提供接口；项目过程数据在 App 侧。

### 7.1 文件资产（中台）
- 上传文件：POST `/api/v1/files/upload`
- 去重检查：GET `/api/v1/files/check/{sha256}`
- 预览：GET `/api/v1/files/{id}/preview`
- 下载：GET `/api/v1/files/{id}/download`
- 文件信息：GET `/api/v1/files/{id}/info`

### 7.2 文件类型（中台）
- 文件类型列表：GET `/api/v1/doc-types/list`
- 启用的文件类型：GET `/api/v1/doc-types/all`
- 文件类型完整信息（含字段+示例）：GET `/api/v1/doc-types/full/{idOrCode}`
- 筛选选项：GET `/api/v1/doc-types/filter-options`

### 7.3 字段定义（中台）
- 字段列表：GET `/api/v1/doc-field-defs/list`
- 按文件类型取字段：GET `/api/v1/doc-field-defs/by-doc-type/{docTypeId}`

### 7.4 审计规则（中台）
- 规则列表：GET `/api/v1/audit-rules/list`
- 启用规则：GET `/api/v1/audit-rules/all`
- 规则字段关联：GET `/api/v1/audit-rule-field-links/by-rule/{ruleId}`
- 规则法规关联：GET `/api/v1/audit-rule-law-links/by-rule/{ruleId}`

### 7.5 法规与条款（中台）
- 法规列表：GET `/api/v1/law-documents/list`
- 法规条款：GET `/api/v1/law-clauses/by-law/{lawDocumentId}`

---

## 8. MVP 验收标准（0.1）
1) 招标文件解析确认页：字段抽取 + 可编辑 + 可回溯原文 + 创建项目  
2) 文件上传与去重提示：同 sha256 能提示重复并允许复用  
3) 文件分拣：自动分拣 + 人工修正 + 批量确认  
4) 关键信息库：按文件展示字段表，支持确认与原文回溯  
5) 台账：自动汇总部分字段 + 可补录 + 导出 Excel + 缺失清单  
6) 审计：选规则执行，展示过程/证据/依据，生成风险记录  
7) 风险报告：从风险记录生成并导出
